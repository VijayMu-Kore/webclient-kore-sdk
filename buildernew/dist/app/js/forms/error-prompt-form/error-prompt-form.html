<!DOCTYPE html>
<!--
To change this license header, choose License Headers in Project Properties.
To change this template file, choose Tools | Templates
and open the template in the editor.
-->
<div id="btPromptmodal"  class="btPromptmodal btErrorPromptmodal btFullpageModal height-width-100" ng-class="{'viewMode':(displayMode !== 'edit')}" data-backdrop="static"  role="dialog" aria-labelledby="gridSystemModalLabel" aria-hidden="true">
    <!-- starting of modal dialog -->
    <div class="modal-dialog modal-lg overflow-hidden">
        <!-- staring of modal content -->
        <div class="modal-content height-width-100">
            <div class="topBar col-xs-12">
                <span class="closeBtn pull-left" ng-click="closePromptDialog()"><span aria-hidden="true"><i class="btx-carrot-left"></i></span></span>
                     <bt-modal-title ng-if="type==='error'" ng-show="editPromptMode" taskname="{{mode==='manageComponents'?'Manage Components':dialogTask.name}}" title="{{displayMode !=='edit'?'View':'Manage Error Messages'}} - {{selectedNode.nodeInfo.type==='form'?'Form':'Entity'}} '{{errorsObject.name}}'" bot="stream"></bt-modal-title>
              
                </div>
            <div class="modal-body synContainer scrollDiv" perfect-scroll dynamic-height dynaoffset = "-140">
                <div class="col-xs-1"></div>
                <div class="col-xs-10" >
                    <div class="form-group col-xs-12">
                        <label class="required-field" ng-if="type==='error'"> <b>{{'error_Message'| i18nString}}</b> </label>
                        <label class="required-field" ng-if="type==='Prompt'"> <b>{{'user_prompt_prompt_messages_label'| i18nString}}</b> </label>
                        <label class="required-field" ng-if="type==='message'"> <b>{{'user_prompt_bot_responses_label'| i18nString}}</b> </label>
                    </div>
                    <div class="form-group col-xs-12" >
                        <accordion >
                            <ng-container ui-sortable="sortableOptionsErrorPromt" ng-model="standardErrors">
                                <accordion-group ng-repeat="prompt in standardErrors track by $index" heading="{{prompt.text}}" is-open="prompt.isOpen" ng-init="prompt.isOpen = false" ng-class="{true:'panelOpen',false:'panelClose'}[prompt.isOpen]" id="prompt-{{$index}}">
                                    <accordion-heading>
                                            <!-- <span class="sortBar ui-sortable-handle">
                                                <img class="grouping" ng-src="{{assetsBase}}images/grouping.png">
                                            </span> -->
                                            <div class="col-xs-12" id="promptHeader-{{$index}}" ng-click="editPrompt($index,prompt.isOpen)">
                                                <span class="quote-left" ng-if="!errorsObject.nodeInfo.nodeInfo.errorPromptSequencing"><img class="layer" ng-src='{{quotsIcon}}'></span>
                                                <span class="sort-left sortBar ui-sortable-handle" ng-if="errorsObject.nodeInfo.nodeInfo.errorPromptSequencing">
                                                    <img class="grouping" ng-src="{{assetsBase}}images/grouping.png">
                                                </span>
                                                <span ng-if="prompt.text !== ''" class="promptText">{{prompt.text}}</span>
                                                <span ng-if="prompt.text === ''" class="promptText italic">{{'user_error_new_error_message'| i18nString}}</span>
                                                <span class="pull-right ovalSpan">
                                                    <span class="savePrompt"><i class="promptSaveSpin" ng-class="['promptSaveSpin'+$index]" aria-hidden="true"></i></span>
                                                    <span ng-if="standardErrors.length>1" class="align-middle-vertical">
                                                        <i class="fa fa-trash-o trash-icon" aria-hidden="true"  ng-click="deleteErrorMessage($event,$index)"></i>
                                                    </span>
                                                    <span ng-if="prompt.channel==='default'" class="Oval-15 default">
                                                        <div class="iconTitle">{{'all_channels'| i18nString}}<i class="fa  fa-caret-right rightArrow"></i></div>
                                                        <span class="channelText">{{'All'| i18nString}}</span>
                                                    </span>
                                                    <span ng-if="prompt.channel!=='default' && prompt.channel!=='skype' && prompt.channel!=='wfacebook' && prompt.channel !== 'googleactions'" class="Oval-15 no-background">
                                                        <div class="iconTitle">{{_channelConfig.channelsObject[prompt.channel].name}}<i class="fa  fa-caret-right rightArrow"></i></div>
                                                        <img class="img fa fa-{{prompt.channel}}" ng-src="{{_channelConfig.channelsObject[prompt.channel].icon}}" aria-hidden="true">
                                                    </span>
                                                    <span ng-if="prompt.channel === 'googleactions'" class="Oval-15 no-background">
                                                        <img class="img" ng-src="{{assetsBase}}images/google-home.svg">
                                                        <div class="property-panelIconTitle">{{'Google_asstnt'| i18nString}}<i class="fa  fa-caret-left leftArrow"></i></div> 
                                                    </span>
                                                    <span ng-if="prompt.channel!=='default' && prompt.channel==='skype' && prompt.channel!=='wfacebook'" class="Oval-15 no-background">
                                                        <div class="iconTitle">{{_channelConfig.channelsObject[prompt.channel].name}}<i class="fa  fa-caret-right rightArrow"></i></div>
                                                        <span class="img fa fa-{{prompt.channel}}" ng-src="{{_channelConfig.channelsObject[prompt.channel].icon}}" aria-hidden="true"></span> 
                                                    </span>
                                                    <span ng-if="prompt.channel==='wfacebook'" class="Oval-15 no-background">
                                                        <div ng-if="prompt.isMention" class="iconTitle">{{_constants_.iconsTooltips['Workplace For Groups']}}<i class="fa  fa-caret-right rightArrow"></i></div>
                                                        <div ng-if="!prompt.isMention" class="iconTitle">{{_constants_.iconsTooltips['Workplace For Chat']}}<i class="fa  fa-caret-right rightArrow"></i></div>
                                                        <img class="img fa fa-{{prompt.channel}}" ng-src="{{_channelConfig.channelsObject[prompt.channel].icon}}" aria-hidden="true"></img> 
                                                    </span>
                                                    <span class="align-middle-vertical"><i ng-class="{true:'fa fa-angle-up panel-heading-Btn-icon',false:'fa fa-angle-down panel-heading-Btn-icon'}[prompt.isOpen]"></i></span>
                                                </span>
                                            </div>
                                        </accordion-heading>
                                    <div class="inner-accordion-body">
                                    <div ng-if="currentTabIndexOfPage2 == 0 || currentTabIndexOfPage2 == 1">
                                            <label class="required-field selectLabel">{{'channel_name'| i18nString}}</label>
                                            <div class="channel-list">
                                                <select class="form-control selectChannel" ng-model="selectedChannel.channel" ng-change="channelSelected(selectedChannel.channel)">
                                                    <option value="default">{{'all_channels'| i18nString}}</option>
                                                    <option ng-repeat="channel in channels" value="{{channel.id}}">{{channel.name}}</option>
                                                </select>
                                            </div>
                                            <div class="col-xs-12 protipNoPadding" ng-show="selectedChannel.channel === 'alexa'">
                                                            <div class="hintDiv width735">
                                                                <span class="icon"><i class="btx-bulb" ></i></span>
                                                            <span class="description ng-binding" ng-bind-html="$root.getSanitizedText($root.lableData.bb539)"></span>
                                                            </div>
                                            </div>
                                        </div>
                                        <div class="col-xs-12 noPadding marginTop15">
                                        <span class="col-xs-8 messageLabel">
                                            <label class="required-field marginTopBt5"> <b>{{'constants.flowtasks_message'| i18nString}}</b> </label>
                                        </span>
                                            <span ng-if="currentTabIndexOfPage2 == 1" class="col-xs-4 noPadding floatRight"><sample-tempalets  selected-channel="selectedChannelType" selected-callback="editingError.jsCode" demo-templates="demoTemplates" tab-index="currentTabIndexOfPage2"></sample-tempalets></span>
                                        </div>
                                        <div>
                                        <div ng-if="currentTabIndexOfPage2 == 0 && prompt.isOpen && loadEditor" class="content-padding">
                                            <div ng-if="prompt.isOpen && loadEditor" class="col-xs-12 standard-label-div markDownStyle noPadding" ng-init="showProtip=true">
                                                <markdown-editor [initial-text]="myMarkdownText" callback='markdownCbs' ng-focus="handleEditorPlaceholder($event)" ng-model="editingError.markUp"></markdown-editor>
                                            </div>
                                            <div class="col-xs-12 protipNoPadding" ng-show="true">
                                                            <div class="hintDiv width735">
                                                                <span class="icon"><i class="btx-bulb"></i></span>
                                                            <span class="description ng-binding" ng-bind-html="$root.getSanitizedText($root.lableData.bb529)"></span>
                                                            </div>
                                            </div>
                                        </div>
                                        <div ng-if="currentTabIndexOfPage2 == 1" class="content-padding">
                                            <div class="form-group jsDiv">
                                                <div>
                                                    <div class=" prompt-jsEditor container">
                                                        <div class="panel-default">
                                                            <div class="panel-heading">
                                                                <h3 ng-click="alterTabsOfPage2(0)" class="panel-title reduceOpacity">{{'plain_text_label'| i18nString}}</h3>
                                                                <h3 ng-click="alterTabsOfPage2(1)" class="panel-title ja-marginleft">{{'bot_welcomeMessage_javscript_label'| i18nString}}</h3>
                                                                <h3 ng-click="alterTabsOfPage2(2)" class="panel-title reduceOpacity">{{'preview_name'| i18nString}}</h3>
                                                                
                                                            </div>
                                                            <div class="panel-body">
                                                                <div ng-if="prompt.isOpen" id="jseditor" class="jseditor" acify callback='jsEditorCbs' ng-model="editingError.jsCode" ng-focus="showProtip = !showProtip"></div>
                                                            </div>
                                                            <div class="col-xs-12 protipNoPadding" ng-show="true">

                                                            <div class="hintDiv width735">
                                                                <span class="icon"><i class="btx-bulb"></i></span>
                                                            <span class="description ng-binding" ng-bind-html="$root.getSanitizedText($root.lableData.bb537)"></span>
                                                            </div>
                                                            </div>
                                                        </div>
                                                    </div>    
                                                </div>
                                            </div>
                                        </div>
                                        <div ng-show="currentTabIndexOfPage2 == 2" class="content-padding">
                                            <div class="form-group jsDiv">
                                                <div>
                                                    <div class=" prompt-jsEditor container">
                                                        <div class="panel-default">
                                                            <div class="panel-heading">
                                                                <h3 ng-click="alterTabsOfPage2(0)" class="panel-title reduceOpacity">{{'plain_text_label'| i18nString}}</h3>
                                                                <h3 ng-click="alterTabsOfPage2(1)" class="panel-title reduceOpacity ja-marginleft">{{'bot_welcomeMessage_javscript_label'| i18nString}}</h3>
                                                                <h3 ng-click="alterTabsOfPage2(2)" class="panel-title">{{'preview_name'| i18nString}}</h3>
                                                            </div>
                                                        </div>
                                                    </div>    
                                                </div>
                                            </div>
                                            <span class="previewDesc">{{'bot_welcomeMessage_preview_desc'| i18nString}}</span>
                                            <span class="previewHeading">{{'bot_welcomeMessage_preview_heading'| i18nString}}</span>
                                            <span class="previewHint"><b>{{'hint_label'| i18nString}} </b>{{'bot_welcomeMessage_previewhint_desc1'| i18nString}} <b>{{'bot_welcomeMessage_previewhint_desc2'| i18nString}}</b>{{'bot_welcomeMessage_previewhint_desc3'| i18nString}}&lt;{{'bot_welcomeMessage_previewhint_desc4'| i18nString}}&gt;.&lt;{{'bot_welcomeMessage_previewhint_desc4'| i18nString}}&gt;</span>
                                            <div class="col-xs-12 noPadding" ng-class="{'canDelete': contextCondition.length > 1}">
                                                <div class="contextCond row col-xs-12 noPadding" ng-repeat="cond in contextCondition">
                                                    <span class="col-xs-6 noPaddingLeft"><input class="form-control condKey" placeholder="{{'key'| i18nString}}" type="text" ng-model="cond.key" ng-focus="addContextCond($index)" context-typeahead/></span>
                                                    <span class="col-xs-6"><input class="form-control condVal" placeholder="{{'value'| i18nString}}" type="text" ng-model="cond.value" ng-focus="addContextCond($index)"/>
                                                        <span class="removeCond"><i class="fa fa-minus-circle" ng-click="onRemoveCond($index)"></i></span>
                                                    </span>
                                                
                                                </div>
                                            </div>
                                            <button class="btn btn-primary pull-right previewBtn" ng-click="getPreviewData()" ng-disabled="disablePreviewBtn">{{'preview_name'| i18nString}}</button>
                                            <div class="col-xs-12 noPadding">
                                                <div class="col-xs-5 line-info"></div>
                                                <div class="col-xs-2 messagePreviewLabel"><label>{{'bot_welcomeMessage_message_preview_uppercase'| i18nString}}</label></div>
                                                <div class="col-xs-5 line-info"></div>
                                            </div>
                                            <div class="preview-box clear-fix">
                                                <div class="preview-message" ng-class="{'previewError': isError}" ng-bind-html="preview"></div>
                                            </div>
                                            <div ng-if="previewIsOn" class="alert-preview">
                                                <div class="alert alert-success alert-sm text-center" role="alert">
                                                    <i class="fa fa-spinner fa-spin"></i> {{'bot_welcomeMessage_resolving_Value_label'| i18nString}}
                                                </div>
                                            </div> 
                                        </div>
                                        
                                    </div>
                                    </div>
                                    <div class="pull-right saveBtnDiv">
                                        <button type="submit" class="btn" ng-disabled="disableSaveBtn()" ng-click="savePromptMessage($index)">{{'save'| i18nString}}</button>
                                        <button type="submit" class="btn closeCancel" ng-click="navigateBack($index)">{{'cancel'| i18nString}}</button>
                                    </div>
                                </accordion-group>    
                            </ng-container>
                        </accordion>
                        <div ng-if="type==='error'" ng-show = "!formDirty() && displayMode !=='view'" class="add-prompt-message" ng-click="addNewErrorMessage()">{{'add_error_prompt'| i18nString}}</div>
                        <div ng-if="type==='error'" class="col-xs-12">
                           <div class="hintDiv marginB20T10 width735">
                            <span class="icon"><i class="btx-bulb"></i></span>
                             <span class="description ng-binding" ng-bind-html="$root.getSanitizedText($root.lableData.bb554)"></span>
                           </div>
                        </div>
                    </div>
                </div>
                <div class="col-xs-1"></div>
            </div>
        </div>
        <!-- /.modal-content --> 
    </div>
    <!-- /.modal-dialog -->
    <footer-info ng-if="updateFooterHeader() && type==='error'">
        <div ng-bind-html="$root.getSanitizedText($root.lableData.bb553)"></div>
    </footer-info>
</div>

