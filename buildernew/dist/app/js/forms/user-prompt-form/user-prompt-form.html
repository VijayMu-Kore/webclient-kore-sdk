<div id="btPromptmodal"  class="btPromptmodal btFullpageModal height-width-100" ng-class="{'viewMode':(displayMode !== 'edit')}" data-backdrop="static"  role="dialog" aria-labelledby="gridSystemModalLabel" aria-hidden="true">
    <!-- starting of modal dialog -->
    <div class="modal-dialog modal-lg overflow-hidden">
        <!-- staring of modal content -->
        <div class="modal-content height-width-100">
            <div class="topBar col-xs-12">
                   <span class="closeBtn pull-left" ng-click="closePromptDialog()"><span aria-hidden="true"><i class="btx-carrot-left"></i></span></span>
                     <bt-modal-title ng-if="!promptType && type==='Prompt'" ng-show="editPromptMode" taskname="{{mode==='manageComponents'?'Manage Components':dialogTask.name}}" title="{{displayMode !=='edit'?'View':'Manage'}} {{type}} Messages - {{selectedNode.nodeInfo.type==='form'?'Form':'Entity'}} '{{messagesObject.name}}'" bot="stream"></bt-modal-title>
                     <bt-modal-title ng-if="promptType" ng-show="editPromptMode" taskname="{{mode==='manageComponents'?'Manage Components':dialogTask.name}}" title="{{displayMode !=='edit'?'View':'Manage'}} {{promptType.charAt(0).toUpperCase()+promptType.substr(1).toLowerCase()}} Messages - {{selectedNode.nodeInfo.type==='form'?'Form':'Entity'}} '{{messagesObject.name}}'" bot="stream"></bt-modal-title>
                      <bt-modal-title ng-if="type==='message'" ng-show="editPromptMode" taskname="{{mode==='manageComponents'?'Manage Components':dialogTask.name}}" title="{{displayMode !=='edit'?'View':'Manage'}} Bot Responses - Message '{{messagesObject.name}}'" bot="stream"></bt-modal-title>
                     
                  
                  
                    <!--<button class="btn btn-primary pull-right btnSave" ng-disabled="!canFinish()" ng-click="savePromptsInfo()" style="position: relative;top: 15px;right: 20px;">Finish</button>-->
              
                </div>
            <div class="modal-body synContainer scrollDiv" perfect-scroll dynamic-height dynaoffset = "-140">
                <div class="col-xs-1"></div>
                <div class="col-xs-10">
                    <div class="form-group col-xs-12">
                        <label class="required-field" ng-if="promptType"> <b>{{'user_prompt_submit_messages_label'| i18nString}}</b> </label>
                        <label class="required-field" ng-if="!promptType && type==='Prompt'"> <b>{{'user_prompt_prompt_messages_label'| i18nString}}</b> </label>
                        <label class="required-field" ng-if="type==='message'"> <b>{{'user_prompt_bot_responses_label'| i18nString}}</b> </label>
                    </div>
                    <div class="form-group col-xs-12">
                        <accordion>
                            <accordion-group ng-repeat="prompt in _allPrompts track by $index" heading="{{prompt.text}}" is-open="prompt.isOpen" ng-init="prompt.isOpen = false" ng-class="{true:'panelOpen',false:'panelClose'}[prompt.isOpen]" id="prompt-{{$index}}">
                                <accordion-heading>
                                        <div class="col-xs-12" id="promptHeader-{{$index}}" ng-click="editPrompt($index,prompt.isOpen)">
                                            <span class="quote-left"><img class="layer" ng-src='{{quotsIcon}}'></span>
                                            <span ng-if="prompt.text !== ''" class="promptText">{{prompt.text}}</span>
                                            <span ng-if="promptType && prompt.text === ''" class="promptText italic">{{'user_submit_new_submit_message'| i18nString}}</span>
                                            <span ng-if="!promptType && prompt.text === ''" class="promptText italic">{{'user_prompt_new_prompt_message'| i18nString}}</span>
                                            <span class="pull-right ovalSpan">
                                                <span class="savePrompt"><i class="promptSaveSpin" ng-class="['promptSaveSpin'+$index]" aria-hidden="true"></i></span>
                                                <span ng-if="_allPrompts.length>1" class="align-middle-vertical"><i class="fa fa-trash-o trash-icon" aria-hidden="true"  ng-click="deletePromptMessage($event,$index)"></i></span>
                                                <span ng-if="prompt.channel==='default'" class="Oval-15 default"><div class="iconTitle">{{'all_channels'| i18nString}}<i class="fa  fa-caret-right rightArrow"></i></div><span class="channelText">ALL</span></span>
                                                <span ng-if="prompt.channel!=='default' && prompt.channel!=='skype' && prompt.channel!=='wfacebook' && prompt.channel!=='googleactions'" class="Oval-15 no-background"><div class="iconTitle">{{_channelConfig.channelsObject[prompt.channel].name}}<i class="fa  fa-caret-right rightArrow"></i></div><img class="img fa fa-{{prompt.channel}}" ng-src="{{_channelConfig.channelsObject[prompt.channel].icon}}" aria-hidden="true"></img> </span>

                                                <span ng-if="prompt.channel!=='default' && prompt.channel==='skype' && prompt.channel!=='wfacebook'" class="Oval-15 no-background"><div class="iconTitle">{{_channelConfig.channelsObject[prompt.channel].name}}<i class="fa  fa-caret-right rightArrow"></i></div><span class="img fa fa-{{prompt.channel}}" ng-src="{{_channelConfig.channelsObject[prompt.channel].icon}}" aria-hidden="true"></span> </span>

                                                <span ng-if="prompt.channel === 'googleactions'" class="Oval-15 no-background"><div class="iconTitle">{{'google_ass'| i18nString}}<i class="fa  fa-caret-right rightArrow"></i></div><img class="img" ng-src="{{assetsBase}}images/google-home.svg"> </span>

                                                <span ng-if="prompt.channel==='wfacebook'" class="Oval-15 no-background"><div ng-if="prompt.isMention" class="iconTitle">{{_constants_.iconsTooltips['Workplace For Groups']}}<i class="fa  fa-caret-right rightArrow"></i></div><div ng-if="!prompt.isMention" class="iconTitle">{{_constants_.iconsTooltips['Workplace For Chat']}}<i class="fa  fa-caret-right rightArrow"></i></div><img class="img fa fa-{{prompt.channel}}" ng-src="{{_channelConfig.channelsObject[prompt.channel].icon}}" aria-hidden="true"></img> </span>
                                                <span class="align-middle-vertical"><i ng-class="{true:'fa fa-angle-up panel-heading-Btn-icon',false:'fa fa-angle-down panel-heading-Btn-icon'}[prompt.isOpen]"></i></span>
                                            </span>
                                        </div>
                                    </accordion-heading>
                                <div class="inner-accordion-body">
                                    <div ng-if="currentTabIndexOfPage2 == 0 || currentTabIndexOfPage2 == 1">
                                        <label class="required-field selectLabel">{{'channel_name'| i18nString}}</label>
                                        <div class="channel-list">
                                            <select class="form-control selectChannel" ng-model="selectedChannel.channel" ng-change="channelSelected(selectedChannel.channel)">
                                                <option value="default">{{'all_channels'| i18nString}}</option>
                                                <option ng-repeat="channel in channels" value="{{channel.id}}">{{channel.name}}</option>
                                            </select>
                                </div>
                                        <div class="col-xs-12 protipNoPadding" ng-show="selectedChannel.channel === 'alexa'">
                                            <div class=" width735">
                                                  <span class="icon"><i class="btx-bulb" ></i></span>
                                               <span class="description ng-binding" ng-bind-html="$root.getSanitizedText($root.lableData.bb539)"></span>
                                </div>
                                         </div>
                                    </div>
                                    <div class="col-xs-12 noPadding marginTop15 manageBotResponses">
                                    <span class="col-xs-8 messageLabel">
                                        <label class="required-field marginTopBt5"> <b>{{'constants.flowtasks_message'| i18nString}}</b> </label>
                                    </span>
                                        <span ng-show="currentTabIndexOfPage2 == 1" class="col-xs-4 noPadding floatRight"><sample-tempalets selected-channel="selectedChannelType" selected-callback="editingMessage.jsCode" demo-templates="demoTemplates" tab-index="currentTabIndexOfPage2"></sample-tempalets></span>
                                    </div>
                                    <div class="promptsEditor">
                                    <div ng-if="currentTabIndexOfPage2 == 0 && prompt.isOpen && loadEditor" class="content-padding">
                                        <div ng-if="prompt.isOpen && loadEditor" class="col-xs-12 standard-label-div markDownStyle noPadding" ng-init="showProtip=true">
                                            <markdown-editor [initial-text]="myMarkdownText" callback='markdownCbs' ng-focus="handleEditorPlaceholder($event)" ng-model="editingMessage.markUp"></markdown-editor>
                                        </div>
                                        <div class="col-xs-12 protipNoPadding" ng-show="true">
                                            <div class="hintDiv width735">
                                                  <span class="icon"><i class="btx-bulb" ></i></span>
                                               <span class="description ng-binding" ng-bind-html="$root.getSanitizedText($root.lableData.bb529)"></span>
                                            </div>
                                         </div>
                                    </div>
                                    <div ng-if="currentTabIndexOfPage2 == 1" class="content-padding">
                                        <div class="form-group jsDiv">
                                            <div>
                                                <div class=" prompt-jsEditor container">
                                                    <div class="panel panel-default noBorder">
                                                        <div class="panel-heading">
                                                            <h3 ng-click="alterTabsOfPage2(0)" class="panel-title reduceOpacity">{{'plain_text'| i18nString}}</h3>
                                                            <h3 ng-click="alterTabsOfPage2(1)" class="panel-title ja-marginleft">{{'bot_welcomeMessage_javscript_label'| i18nString}}</h3>
                                                            <h3 ng-click="alterTabsOfPage2(2)" class="panel-title reduceOpacity">{{'preview_name'| i18nString}}</h3>
                                                            
                                                        </div>
                                                        <div class="panel-body marginBottom10">
                                                            <div ng-if="prompt.isOpen" id="jseditor" class="jseditor" acify callback='jsEditorCbs' ng-model="editingMessage.jsCode" ng-focus="showProtip = !showProtip"></div>
                                                        </div>
                                                        <div class="col-xs-12 protipNoPadding" ng-show="true">
                                                        <div class="hintDiv width735">
                                                              <span class="icon"><i class="btx-bulb" ></i></span>
                                                           <span class="description ng-binding" ng-bind-html="$root.getSanitizedText($root.lableData.bb537)"></span>
                                                        </div>
                                                         </div>
                                                    </div>
                                                </div>    
                                            </div>
                                        </div>
                                    </div>
                                    <div ng-show="currentTabIndexOfPage2 == 2" class="content-padding">
                                        <div class="form-group jsDiv">
                                            <div>
                                                <div class=" prompt-jsEditor container">
                                                    <div class="panel-default">
                                                        <div class="panel-heading">
                                                            <h3 ng-click="alterTabsOfPage2(0)" class="panel-title reduceOpacity">{{'plain_text'| i18nString}}</h3>
                                                            <h3 ng-click="alterTabsOfPage2(1)" class="panel-title reduceOpacity ja-marginleft">{{'bot_welcomeMessage_javscript_label'| i18nString}}</h3>
                                                            <h3 ng-click="alterTabsOfPage2(2)" class="panel-title">{{'preview_name'| i18nString}}</h3>
                                                        </div>
                                                    </div>
                                                </div>    
                                            </div>
                                        </div>
                                        <span class="previewDesc">{{'bot_welcomeMessage_preview_desc'| i18nString}}</span>
                                        <span class="previewHeading">{{'bot_welcomeMessage_preview_heading'| i18nString}}</span>
                                        <span class="previewHint"><b>{{'hint_label'| i18nString}} </b>{{'bot_welcomeMessage_previewhint_desc1'| i18nString}} <b>{{'bot_welcomeMessage_previewhint_desc2'| i18nString}}</b>{{'bot_welcomeMessage_previewhint_desc3'| i18nString}}&lt;{{'bot_welcomeMessage_previewhint_desc4'| i18nString}}&gt;.&lt;{{'bot_welcomeMessage_previewhint_desc4'| i18nString}}&gt;</span>
                                        <div class="col-xs-12 noPadding" ng-class="{'canDelete': contextCondition.length > 1}">
                                            <div class="contextCond row col-xs-12 noPadding" ng-repeat="cond in contextCondition">
                                                <span class="col-xs-6 noPaddingLeft"><input class="form-control condKey" placeholder="{{'key'| i18nString}}" type="text" ng-model="cond.key" ng-focus="addContextCond($index)" context-typeahead/></span>
                                                <span class="col-xs-6"><input class="form-control condVal" placeholder="{{'value'| i18nString}}" type="text" ng-model="cond.value" ng-focus="addContextCond($index)"/>
                                                    <span class="removeCond"><i class="fa fa-minus-circle" ng-click="onRemoveCond($index)"></i></span>
                                                </span>
                                               
                                            </div>
                                        </div>
                                        <button class="btn btn-primary pull-right previewBtn" ng-click="getPreviewData()" ng-disabled="disablePreviewBtn">{{'preview_name'| i18nString}}</button>
                                        <div class="col-xs-12 noPadding">
                                            <div class="col-xs-5 line-info"></div>
                                            <div class="col-xs-2 messagePreviewLabel"><label>{{'bot_welcomeMessage_message_preview_uppercase'| i18nString}}</label></div>
                                            <div class="col-xs-5 line-info"></div>
                                        </div>
                                        <div class="preview-box clear-fix">
                                            <div class="preview-message" ng-class="{'previewError': isError}" ng-bind-html="preview"></div>
                                        </div>
                                        <div ng-if="previewIsOn" class="alert-preview">
                                            <div class="alert alert-success alert-sm text-center" role="alert">
                                                <i class="fa fa-spinner fa-spin"></i> {{'bot_welcomeMessage_resolving_Value_label'| i18nString}}
                                            </div>
                                        </div> 
                                    </div>
                                    
                                </div>
                                </div>
                                <div class="pull-right saveBtnDiv">
                                    <button type="submit" class="btn" ng-disabled="disableSaveBtn()" ng-click="savePromptMessage($index)">{{'save'| i18nString}}</button>
                                    <button type="submit" class="btn closeCancel" ng-click="navigateBack($index)">{{'cancel'| i18nString}}</button>
                                </div>
                            </accordion-group>    
                        </accordion>
                        <div ng-if="promptType" ng-show = "!formDirty() && displayMode !=='view'" class="add-prompt-message" ng-click="addNewPromptMessage()" title="{{'add_submit_message_label'| i18nString}}">{{'add_submit_message_label'| i18nString}}</div>
                        <div ng-if="!promptType && type==='Prompt'" ng-show = "!formDirty() && displayMode !=='view'" class="add-prompt-message" ng-click="addNewPromptMessage()" title="{{'add_prompt_message_label'| i18nString}}">{{'add_prompt_message_label'| i18nString}}</div>
                        <div ng-if="type==='message'" ng-show = "!formDirty() && displayMode !=='view'" class="add-prompt-message" ng-click="addNewPromptMessage()">{{'add_bot_response'| i18nString}}</div>
                        <div ng-if="type==='Prompt'" class="col-xs-12">
                           <div class="hintDiv width735">
                            <span class="icon"><i class="btx-bulb" ></i></span>
                             <span class="description ng-binding" ng-bind-html="$root.getSanitizedText($root.lableData.bb531)"></span>
                           </div>
                        </div>
                    </div>
                </div>
                <div class="col-xs-1"></div>
            </div>
        </div>
        <!-- /.modal-content --> 
    </div>
    <!-- /.modal-dialog -->
    <footer-info ng-if="updateFooterHeader() && type==='Prompt'">
        <div ng-bind-html="$root.getSanitizedText($root.lableData.bb530)"></div>
    </footer-info>
    <footer-info ng-if="updateFooterHeader() && type==='message'">
        <div ng-bind-html="$root.getSanitizedText($root.lableData.bb532)"></div>
    </footer-info>
</div>
