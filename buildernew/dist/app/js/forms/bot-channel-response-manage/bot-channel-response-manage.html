<div class="bot-channel-response-manage" ng-class="{'read-only-div':displayMode==='VIEW'}"> 
    <div class="row btnSearchTitle">
        <div class="col-xs-6 leftTitle">
            <p class="pageTitle">{{'ddval_standard'| i18nString}}</p>
        </div>
        <div class="col-xs-6 rightBTNSearch">
            <div class="searchComponent">
                <input tabindex="1" type="text" ng-model="search.text" ng-change="FilterMessages()" placeholder="{{'search_here'| i18nString}}" id="inpSearchStandResp" style="">
                <i class="btx-search"></i>
                <i class="btx-close" ng-click="clearSearch();" ng-class="{displayNone: !search.text.length}"></i>
            </div>
            <div class="titleOverflow"  ng-if="allowNamespace">
                <div class="dropdown ">
                    <a href="#" class="ellipsisGray" data-toggle="dropdown">
                        <i class="btx-overflow"></i>
                        </a>
                    <ul class="dropdown-menu">
                        <li class="dropdown-item" ng-click="manageVarSlider()">{{'manage_var_namespace'| i18nString}}</li>
                    </ul>
                </div>
            </div>

        </div>
    </div>

<div class="utterances-modal-body height-width-100">

    
<node-level-voice-channels-all-sliders ng-if="isStandAllVoiceEnabled" cb="stand_resp_voice_channels_all_cb" nodeInfo="nodeInfo"></node-level-voice-channels-all-sliders>


<div class="container wf-form nlp-screen" ng-hide="loading">
	<div class="row">
		<div class="col-xs-7 modal-tab-header"> 
			<div ng-click="showType(category)"  ng-repeat="category in categories track by $index" class="modal-tabs"  ng-class="{'modal-tabs-active':currentCategory == category.type}">
				{{categoryHeaders[category.type]}} <span ng-show="search.text.length" class="pull-right count badge">{{category.searchResultsCount}}</span>
			</div>
		</div>
	</div>

	<div class="col-xs-12 standard-response-header noPadding">
		<div class="col-xs-12 bt-utterances psScrollZindex noPaddingLeft p-0" dynamic-height dynaoffset = "-250" height-property="height" perfect-scroll>

            <div ng-if="!loading" class="animationIfEnter row utterances-list-div" >
                <div class="col-xs-12 uttrence-view" ng-mouseover="message.showAddOptions = true" ng-mouseleave="message.showAddOptions = false" ng-repeat="message in ( (genericMessages | filter : { type : currentCategory }) | filter : search.text).slice((currentPage-1)*10,currentPage*10)">
                    <div class="col-xs-5 noPadding uttearnce-label">
                        {{message.title}}
<!--                          <span ng-if="message.key == 'Discarded current task to switch to new task'" class="pull-right">
                             <span><button class="btn btn-primary synPublishBtn">Publish</button></span> 
                            <div class="channelResToggleSwitch" has-focus ng-modal="filterToggle">
                                <span ng-click="editStream()">
                                    <span ng-if="!stream.interruptOptions.notifyCancelledMessage"><img ng-src="{{assetsBase}}images/left-menu-img/unselectedCheck.svg" class="discardToggleRadio"> Disabled</span>
                                    <span ng-if="stream.interruptOptions.notifyCancelledMessage "><img ng-src="{{assetsBase}}images/toggle-1.png" class="discardToggleRadio"> Enabled</span>
                                </span>
                            </div>
                    </span>-->
                    </div>
                    <div class="modal fade kr-sg-modal StandardResponseResetValues" id="StandardResponseResetValues" role="dialog">
                        <div class="modal-dialog">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h4 class="modal-title resetValueSize">{{'reset_res'| i18nString}}<i class="btx-close closeEnableUserMsg" ng-click="closeResetConfirmationPopup()"></i></h4>
                                </div>
                                <div class="modal-body">
                                    <i class="btx-warning text-danger resetResponse-icon"></i>
                                    <p class="reset-description">{{'reset_desc'| i18nString}}</p>
                                </div>
                                <div class="modal-footer">
                                    <button class="kr-sg-button-danger btn_lg resetResponseButton" ng-click="updateResponsesToDefault()">{{'reset'| i18nString}}</button>
                                    <button class="kr-sg-button-secondary btn_lg ml-5" data-dismiss="modal">{{'cancel'| i18nString}}</button>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-xs-7 utterance-btn-div pr-45" ng-show="message.showAddOptions">
                        <button ng-if="stream.ivrSettings && stream.ivrSettings.enable" class="utterance-btn"  ng-click="selectMessage(message);editIVRSettings(message)"><i class="btx-add"></i>{{message.ivrOptions?edit:add}}  {{'ivr_properties_normal'| i18nString}}</button>
                        <!-- <span class="utterance-btn"  ng-click="selectMessage(message);addNewGeneric()"><i class="fa  fa-plus"></i> Add Response</span> -->
                        <!-- <span class="utterance-btn pull-right" ng-click="selectMessage(message);createNewOverride()"><i class="fa  fa-plus"></i> Add Channel Response</span> -->
                        <button class="utterance-btn pull-right" ng-click="selectMessage(message);createNewOverride(message)"><i class="btx-add"></i> {{'Add_response'| i18nString}}</button>                    
                    </div>
                    <div ng-show ="!message.hideMessage" class="col-xs-12 utterances-sub-view utterance-item-title" ng-mouseover="customMsg.show = true" ng-mouseleave="customMsg.show = false" ng-repeat="customMsg in message.value track by $index">
                        <span class="text-pad-right">{{customMsg.message}} </span>
                        <div class="utterance-btn-div edit-utterances-options pull-right" ng-show="customMsg.show">
                            <span class="edit-utterances-options-btn" ng-click="selectMessage(message);editGenericMsg($event, $index)"><i ng-src="{{pencilIcon}}"  class="btx-pencil"></i></span>
                            <span class="edit-utterances-options-btn pull-right" style="border-left: 1px solid #BDC1C6;" ng-click="selectMessage(message);removeGenericMsg($event, $index)"><i class="btx-delete-1"></i></span>
                        </div>   
                    </div>  

                    <div class="col-xs-12 utterances-sub-view utterance-item-title" ng-mouseover="option.show = true" ng-mouseleave="option.show = false" ng-repeat="option in message.override track by $index">
                        <div ng-class="{'col-xs-12': option.channel === 'default','col-xs-8': option.channel !== 'default'}" style="padding: 0px;"><span>{{option.isMarkDown?option.uXMap:"Custom Javascript"}}</span></div>
                        <div class='col-xs-4 utternce-override-view'>
                            <div style="text-align: right;">
                                <span ng-if="option.channel === 'default'"></span>
                                <span ng-if="option.channel !== 'default'"> {{ _channelConfig.channelsObject[option.channel].name | channelNameDisp}} - </span>
<!-- 
                                {{option.channel == "ivr" ? "Webhook": ((option.channel=='googleactions')?'Google Assistant' : option.channel) }} - </span> -->

                                <span ng-if="option.channel !== 'default'">{{option.taskLabel}}</span>

                                <span>{{option.fieldLabel !=='-'?'- ' + option.fieldLabel:''}}</span> 
                            </div>  
                        </div>
                        <div class="utterance-btn-div edit-utterances-options pull-right" ng-show="option.show">
                            <span class="edit-utterances-options-btn"  ng-click="selectMessage(message);editOverride($event, option,$index,message,$parent.$index)"><i  class="btx-pencil"></i></span>
                            <span class="edit-utterances-options-btn pull-right" style="border-left: 1px solid #BDC1C6;" ng-click="selectMessage(message);deleteOverride($event, option,$index)"><i class="btx-delete-1"></i></span>
                        </div> 
                    </div>

                    <div class="dropdown kr-sg-overflow-menu" ng-show="message.showAddOptions">
                        <div class="dropdown-toggle" id="menu1" data-toggle="dropdown">
                            <i class="btx-overflow"></i>
                        </div>
                        <ul class="dropdown-menu" role="menu" aria-labelledby="menu1">
                            <li ng-click="resetResponse(message)">
                                <a>{{'reset_res'| i18nString}}</a>
                            </li>
                        </ul>
                    </div> 
                </div>
            </div>
            <div class="text-center" ng-show="search.text && (!( (genericMessages | filter : { type : currentCategory }) | filter : search.text).length)">
                <div class="alert alert-xs alert-warning">
                    {{'no_search_result'| i18nString}} `{{search.text}}`
                </div>
            </div>
		</div>
		<div class="col-xs-12 noPadding standard-response-header pageNationDiv">
			<pagination rotate="false"  max-size="5" ng-show="( (genericMessages | filter : { type : currentCategory }) | filter : search.text).length>10" class="pagination-sm floatNone"  total-items="( (genericMessages | filter : { type : currentCategory }) | filter : search.text).length" items-per-page="10" ng-model="currentPage"></pagination>
		</div>
	</div>

	</div>
    <div class="summaryLoader animationIfLeave" ng-if="loading">
        <span class="spinner-text" id="rightPanelLoadingSpin"> 
            <i class="fa fa-circle-o-notch fa-spin-fast"></i> 
            <span class="spinner-text-content"> Loading...</span>
        </span>
    </div>

	  <!-- <div class="col-xs-12 noBorderTop" ng-if="loading">
                <div class="log-item">
                    <div class="loaderAlert">
                        <div class="alert alert-warning alert-xs text-center" role="alert">
                            <i class="fa-spin fa fa-circle-o-notch"></i> 
                        </div>
                    </div>
                    <div class="col-xs-2"></div>
                </div>
            </div> -->
<footer-info ng-if="updateFooterHeader()">
        <div ng-bind-html="$root.getSanitizedText($root.lableData.bb002)"></div>
</footer-info>
    <div class="modal fade vxml-prop-modal" id="vxml-add" data-backdrop="static" tabindex="-1" role="dialog">
                <div class="modal-dialog vxml-dialog">
                    <div class="modal-content">
                    <div class="modalHeader vxmlHeader">
                        <h4 class="modal-title vxml-title" id="gridSystemModalLabel">{{'new_call_cont_param'| i18nString}} </h4>
                    </div>
                    <form name="vxmlform">
                    <div class="modalBody vxml-body" height-property="height">
                        <div class="newVariable">
                            <div class="col-xs-12  paddingTop10">
                                <div class="required-field name"><label class="vxml-font">{{'param_name'| i18nString}} </label></div>
                                <div><textarea class="form-control autoGrowTA required-field vxml-textarea" name="propertyname" type="text" ng-model="vprop.name" auto-grow-textarea default-grown="true" placeholder="{{'place_param'| i18nString}}" ng-required="true"></textarea></div>
                            </div>
                            <div class="col-xs-12 paddingTop10">
                                <div class="required-field name"><label class="vxml-font">{{'value'| i18nString}}</label></div>
                                <div><textarea class="form-control autoGrowTA required-field vxml-textarea" name="propertyvalue" type="text" ng-model="vprop.value" auto-grow-textarea default-grown="true" placeholder="{{'enter_value'| i18nString}}Enter value" ng-required="true"></textarea></div>
                            </div>
                        </div>
                    </div>
                    </form>
                <div class="modalFooter vxml-footer">
                        <button class="btn saveSubmit" ng-click="addProperty(vprop)" ng-disabled="vxmlform.$invalid" class="btn">{{'confirm'| i18nString}}</button>
                        <button ng-click="closeNodeVxmlProp()" class="btn closeCancel">{{'cancel'| i18nString}}</button>

                </div>
            </div>
    </div>
    </div> 
</div>
</div>    
<manage-variable-namespace cb='manage_var_channel_response' class="manage-variable" id="manageVarNamespaceChannelResp" ng-if="manageVarChannelRespEnable"></manage-variable-namespace>

<bot-modal-slider id="standardResSlider">
    <div class="modalSliderContainer width700">
 
 <!--Header Starts Here -->
       <div class="modalHeader">
          <h4 class="modal-title"><i class="btx-close" ng-click="closeAddMessage()" ></i>{{modalTitle}}</h4>
       </div>
 <!-- Header Starts Here -->
 
 <!-- Body Starts Here -->
     <div class="modalBody add-message" perfect-scroll dynamic-height dynaoffset="-120" height-property="height">
         <div ng-if="editLocked" class="helphint-border marginTopBottomTen col-xs-12"><div class="col-xs-1 bulbicon"><span><span class="icon"><i class="btx-bulb" ></i></span></div><div class="col-xs-11"><span class="name"> {{'edit_standard_res'| i18nString}}</span></div></div>
         <div>
             <div class="col-xs-12 noPadding" ng-if="newGenericInProgress">
                 <!-- <div class="form-group row">
                     <markdown-editor callback="markdownCB1" ng-model="newGeneric.value"></markdown-editor>
                 </div> -->
                 <div class="form-group row override-outer">
                     <div class="channel-selector">
                             <label>{{'channel_name'| i18nString}}</label>
                         <div>
                             <select class="" ng-init = "newGeneric.channel = 'default'" ng-model="newGeneric.channel" ng-change="channelChanged()">
                                 <option value=""> {{'choose_channel'| i18nString}}</option>
                                 <option selected value="default"> {{'any_channel'| i18nString}}</option>
                                 <option ng-repeat="option in availableChannels" value="{{option.id}}">{{option.name}}</option>
                             </select>
                         </div>
                     </div>
 
                     <div class="task-selector marginTop20" ng-show="newGeneric.channel && newGeneric.channel !== 'default'">
                             <label>{{'task'| i18nString}}</label>
                         <div>
                             <select class="" id="select2" ui-select2="selectConfig" ng-model="newGeneric.taskId" ng-change="getTaskFields()">
                                 <option value=""> {{'choose_task'| i18nString}}</option>
                                 <option value="default"> {{'any_task'| i18nString}}</option>
                                 <optgroup label="{{taskItem.type}}" ng-repeat="taskItem in tasksByType">
                                     <option ng-repeat="task in taskItem.tasks" value="{{task._id}}" >{{task.name | taskNameFormat : task}}</option>
                                 </optgroup>
                             </select>
                         </div>
                     </div>
 
                     <div class="field-selector marginTop20" ng-show="newGeneric.taskId && newGeneric.taskId !== 'default' && newGeneric.channel !== 'default'">
                    
                             <label>{{'field'| i18nString}}</label>
                         <div>
                             <select class="" ng-model="newGeneric.fieldId">
                                 <option value="">{{'choose_field'| i18nString}}</option>
                                 <option value="default">{{'any_field'| i18nString}}</option>
                                 <option ng-if="option.key && option.title" ng-repeat="option in availableFields" value="{{option.key}}">{{option.title}}</option>
                                 <option ng-if="option._id && option.name"  ng-repeat="option in availableFields" value="{{option._id}}">{{option.name}}</option>
                             </select>
                         </div>
                     </div>
 
                     <div class="override-message marginTop20" ng-if="newGeneric.channel === 'default' || newGeneric.taskId === 'default' || newGeneric.fieldId">
                         <div>
                             <label class="marginTop10 noMarginBottom">{{'response'| i18nString}}</label>
 
                             <div class="editor-chooser">
                                 <button type="button" class="btn noBorderBtm" ng-class="{active: newGeneric.isMarkDown}" ng-click="activeTabType('basic',newGeneric)">{{'simple_mode'| i18nString}}</button>
                                 <button type="button" class="btn noBorderBtm" ng-class="{active: !newGeneric.isMarkDown}" ng-click="activeTabType('uXMap',newGeneric)">{{'advanced_mode'| i18nString}}</button>
 
                             </div>
                             <span class="pos-relative floatRight" ng-show="!newGeneric.isMarkDown"><sample-tempalets selected-channel="newGeneric.channel" selected-callback="newGeneric.jsEditorValue" demo-templates="demoTemplates" class="stdRespo"></sample-tempalets></span>
                         </div>
                         <markdown-editor callback="markdownCB1" ng-model="newGeneric.value" ng-show="newGeneric.isMarkDown"></markdown-editor>
                         <div class="" acify id="jseditor" callback='jsEditorCallbacks' ng-model="newGeneric.jsEditorValue" ng-show="!newGeneric.isMarkDown"></div>
                     </div>
                 </div>
             </div> 
             <div class="col-xs-12 noPadding" ng-if="newOverrideInProgress">
                 <div class="form-group row override-outer">
                     <div class="channel-selector">
                             <label>{{'channel_name'| i18nString}}</label>
                         <div>
                             <select class="" ng-model="newOverride.channel" ng-change="channelChanged()">
                                 <option value="">{{'choose_channel'| i18nString}}</option>
                                 <option value="default">{{'any_channel'| i18nString}}</option>
                                 <option ng-repeat="option in availableChannels" value="{{option.id}}">{{option.name}}</option>
                             </select>
                         </div>
                     </div>
 
                     <div class="task-selector marginTop20" ng-show="newOverride.channel && newOverride.channel !== 'default'">
                             <label>{{'task'| i18nString}}</label>
                         <div>
                             <select class="" id="select2" ui-select2="selectConfig" ng-model="newOverride.taskId" ng-change="getTaskFields()">
                                 <option value="">{{'choose_task'| i18nString}}</option>
                                 <option value="default">{{'any_task'| i18nString}}</option>
                                 <optgroup label="{{taskItem.type}}"  ng-repeat="taskItem in tasksByType">
                                     <option ng-repeat="task in taskItem.tasks" value="{{task._id}}" >{{task.name | taskNameFormat : task}}</option>
                                 </optgroup>
                             </select>
                         </div>
                     </div>
 
                     <div class="field-selector marginTop20" ng-show="newOverride.taskId && newOverride.taskId !== 'default' && newOverride.channel !== 'default'">
                        <label>{{'field'| i18nString}}</label>
                         <div>
                             <select class="" ng-model="newOverride.fieldId">
                                 <option value="">{{'choose_field'| i18nString}}</option>
                                 <option value="default">{{'any_field'| i18nString}}</option>
                                 <option ng-if="option.key && option.title" ng-repeat="option in availableFields" value="{{option.key}}">{{option.title}}</option>
                                 <option ng-if="option._id && option.name"  ng-repeat="option in availableFields" value="{{option._id}}">{{option.name}}</option>
                             </select>
                         </div>
                     </div>
 
                     <div class="override-message marginTop20" ng-if="newOverride.channel === 'default' || newOverride.taskId === 'default' || newOverride.fieldId">
                         <div>
                             <label class="marginTop10 noMarginBottom">{{'response'| i18nString}}</label>
                         <div class="editor-chooser">
                             <button type="button" class="btn noBorderBtm" ng-class="{active: newOverride.isMarkDown}" ng-click="activeTabType('basic',newOverride)">{{'simple_mode'| i18nString}}</button>
                             <button type="button" class="btn noBorderBtm" ng-class="{active: !newOverride.isMarkDown}" ng-click="activeTabType('uXMap',newOverride)">{{'advanced_mode'| i18nString}}</button>
                         </div>
                             <span class="pos-relative floatRight" ng-show="!newOverride.isMarkDown"><sample-tempalets selected-channel="newOverride.channel" selected-callback="newOverride.jsEditorValue" demo-templates="demoTemplates" class="stdRespo"></sample-tempalets></span>
                         </div>
                         <markdown-editor callback="markdownCB2" ng-model="newOverride.markdownValue" ng-show="newOverride.isMarkDown"></markdown-editor>
                         <div class="" acify id="jseditor" callback='jsEditorCallbacks' ng-model="newOverride.jsEditorValue" ng-show="!newOverride.isMarkDown"></div>
                     </div>
                 </div>
             </div>
             <!-- user authorization protip -->
             <div class="col-xs-12 noPadding userAutProtip" ng-if="userAuthorizationFlag">
                <div class="help_hint_data" >
                    <div class="bulb-icon">
                        <i class="btx-bulb"></i>
                    </div>
                    <div class="hint-content">Protip: {{'userAuthProtip'| i18nString}} <a href="https://developer.kore.ai/docs/bots/advanced-topics/koreutil-libraries/#koreUtilgetCurrentOptions" target="_blank" rel="noopener noreferrer">Know more</a></div>
                </div>
             </div>
         </div>
      
     </div>
 <!-- Body Ends Here -->
 
 <!-- Footer Starts Here -->
       <div class="modalFooter">
                 <span ng-if="!newGenericInProgress && !newOverrideInProgress">
                     <button type="button" class="btn" ng-click="closeAddMessage()">{{'done'| i18nString}}</button>
                 </span>
                 <span ng-if="newGenericInProgress">
                     <button type="button" class="btn" ng-class="{inactive: !newGeneric.value.length || savingNewGeneric}" ng-click="saveNewGeneric($index)">{{savingNewGeneric ? savingLabel : save}}</button>
                     <button type="button" class="btn closeCancel" ng-click="closeAddMessage()">{{'cancel'| i18nString}}</button>
                 
                 </span>
                 <span ng-if="newOverrideInProgress"> 
                     <button type="button" class="btn" ng-class="{inactive: (newOverride.isMarkDown && !newOverride.markdownValue.length) || (!newOverride.isMarkDown && !newOverride.jsEditorValue.length) || savingNewOverride}" ng-disabled="!(newOverride.markdownValue || newOverride.jsEditorValue)" ng-click="saveNewOverride($index)">{{savingNewOverride ? savingLabel : save}}</button>
                     <button type="button" class="btn closeCancel" ng-click="closeAddMessage()">{{'cancel'| i18nString}}</button>
                    
                 </span>
       </div>
 <!-- Footer Ends Here -->
 
    </div>
 </bot-modal-slider>
     
 <bot-modal-slider id="IVRSettingsSlider" class="standard-resp-ivr-settings">
     <div class="modalSliderContainer width700">
 
         <!--Header Starts Here -->
         <div class="modalHeader">
             <h4 class="modal-title"> <i class="btx-close" ng-click="closeIVRSettings()" ></i>{{'ivr_properties_normal'| i18nString}}</h4>
         </div>
         <!-- Header Starts Here -->
 
         <!-- Body Starts Here -->
         <div class="modalBody add-message" perfect-scroll dynamic-height dynaoffset="-110" height-property="height">
             <ivr-settings ng-if="editIVR" ivr-options="ivrOptions" bridge="ivrBridge" callback="cbIvr"></ivr-settings>
         </div>
         <!-- Body Ends Here -->
 
         <!-- Footer Starts Here -->
         <div class="modalFooter">
                 <span>
                     <button type="button" class="btn" ng-click="saveIVRSettings(true,'saved')">{{'save'| i18nString}}</button>
                 </span>
                 <span> 
                     <button type="button" class="btn closeCancel" ng-click="closeIVRSettings()">{{'cancel'| i18nString}}</button>
                 </span>
         </div>
         <!-- Footer Ends Here -->
     </div>
 </bot-modal-slider>
<bot-modal-slider id='ivrStandResp'>
    <div class="modalSliderContainer width700">
        <div class="modalHeader channelModalHeader">
            <h4 class="modal-title" id="gridSystemModalLabel">
                <i class="btx-close" ng-click="closeBotLevelIvr()"></i>{{'Ivr_settings_modal_title'| i18nString}}
            </h4>
        </div>
        <div class="modalBody alertFieldFormScroll" perfect-scroll dynamic-height dynaoffset="-115" height-property="height">
            <div class="col-xs-12">
                <bt-ivr-settings stream-id="{{streamId}}" callback="callbackSrIvr"></bt-ivr-settings>
            </div>
        </div>
        <div class="modalFooter">
                <button ng-click="saveIvrStream()" class="btn saveBtn">{{'save'| i18nString}}</button>
                <button class="btn closeCancel" ng-click="closeBotLevelIvr()">Cancel</button>
        </div>
    </div>
</bot-modal-slider>