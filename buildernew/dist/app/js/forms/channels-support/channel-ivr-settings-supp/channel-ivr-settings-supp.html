<div id="channel-ivr-support">
    <form name="ivrSettSupp.ivrForm" ng-if="!isLoading" novalidate>
        <div class='form-group'>
            <div class='noPadding'>
               <label class='required-field'>{{'end_conversation_behave'| i18nString}}</label>
            </div>
            <div class="grayInfoText noPadding marginT5 ">{{"def_bot_behave"| i18nString}}</div>
            <div class="radioDiv" ng-class="{'screenFreeze':streamState=='published'}">
               <span class="radioInnerDiv paddingRight20">
               <label for="trigger">
               <input value='trigger' type="radio" ng-model="conver.value" name="conversationBehavior" id="trigger"><span>{{"trigger_event"| i18nString}}</span>
               </label>
               </span>
               <span class="radioInnerDiv">
               <label for="terminate">
               <input value='terminate' type="radio" ng-model="conver.value" name="conversationBehavior" id="terminate"><span>{{"terminate_call_label"| i18nString}}</span>
               </label>
               </span>
            </div>
         </div>

         <div class="events-form" ng-if='conver.value === "trigger"'>
            <div class='form-group'>
               <div class='noPadding'>
                  <label class='required-field'>{{"event_config"| i18nString}}</label>
               </div>
               <div class="grayInfoText noPadding marginT5 marginBottom10">{{"def_proceed_event"| i18nString}}</div>
            </div>
            <div class="">
               <div class="radioDiv space-between" ng-class="{'screenFreeze':streamState=='published'}">
                  <span class="radioInnerDiv">
                  <label for="initiate">
                  <input value='initiate' type="radio" ng-model="events.config" name="eventConfig" id="initiate"><span>{{"trigger_dialog"| i18nString}}</span>
                  </label>
                  </span>
                  <span class="radioInnerDiv">
                  <label for="runScript">
                  <input value='runScript' type="radio" ng-model="events.config" name="eventConfig" id="runScript"><span>{{"run_script"| i18nString}}</span>
                  </label>
                  </span>
                  <span class="radioInnerDiv">
                  <label for="showMessage">
                  <input value='showMessage' type="radio" ng-model="events.config" name="eventConfig" id="showMessage"><span>{{"show_msg"| i18nString}}</span>
                  </label>
                  </span>                        
               </div>
            </div>
            <div class="initiate-block" ng-if='events.config === "initiate"' ng-class="{'screenFreeze':streamState=='published'}">
               <div class="form-group eventConfigurationDropDown">
                  <select ng-model='selected.dialog' class='form-control' name='selectTask' required ng-if='isDialogsAvailable'>
                     <option value="" disabled selected>{{"select_task_name"| i18nString}}</option>
                     <option ng-repeat="nameD in dialogsName track by $index" value="{{nameD.name}}">{{nameD.name}}</option>
                  </select>
                  <div error-alert ng-show="ivrSettSupp.ivrForm.selectTask.$error.required && submitForm"  class="text-danger">
                     {{"please_select_task"| i18nString}}
                  </div>
                  <span ng-if='!isDialogsAvailable'><i class="fa fa-spinner fa-spin"></i>{{"loading_tasks"| i18nString}}</span>
               </div>            
               <div class="help_hint_data mb-0">
                  <div class="bulb-icon">
                      <i class="btx-bulb"></i>
                  </div>
                  <div class="hint-content">{{"handle_nl"| i18nString}}</div>
              </div>
            </div>
            <div class="run-script-block" ng-if='events.config === "runScript"' ng-class="{'screenFreeze':streamState=='published'}">
               <div class="noPaddingLeft">
                  <div id="ux-script-editor-dialog" name='textScript' required acify ng-model="inp.scriptText" callback="codeCallback"></div>
               </div>
               <div error-alert ng-show="(ivrSettSupp.ivrForm.textScript.$error.required && ivrSettSupp.ivrForm.textScript.$dirty) || (ivrSettSupp.ivrForm.textScript.$error.required && submitForm)"  class="text-danger">
                  {{"please_add_script"| i18nString}}
               </div>             
               <div class="help_hint_data mb-0">
                  <div class="bulb-icon">
                      <i class="btx-bulb"></i>
                  </div>
                  <div class="hint-content">{{"handle_nl"| i18nString}}</div>
              </div>
            </div>
            <div class="show-message-block" ng-if='events.config === "showMessage"' ng-class="{'screenFreeze':streamState=='published'}">
               <button class='btn btn-primary' ng-click="editResponse(-1)">
               <i class="fa fa-plus"></i>{{"add_response_label"| i18nString}}
               </button>
               <div class="welcomeMessageDiv" ng-repeat="prompt in responseObj track by $index">
                  <div class="msgDiv">
                     <span class="imgDivCircle">
                        <span ng-if="prompt.channel==='default'" class="Oval-15 default"  tooltip-placement="right" tooltip="All Channels"><span class="channelText">{{"All"| i18nString}}</span></span>
                        <span ng-if="prompt.channel!=='default' && prompt.channel!=='skype' && prompt.channel!=='wfacebook' && prompt.channel !== 'googleactions'" class="Oval-15 no-background" tooltip-placement="right" tooltip="{{channelsConfig.channelsObject[prompt.channel].name}}"><img class="img fa fa-{{prompt.channel}}"  ng-src="{{channelsConfig.channelsObject[prompt.channel].icon}}" aria-hidden="true"></span>
                        <span ng-if="prompt.channel === 'googleactions'" class="Oval-15 no-background">
                           <img class="img" ng-src="{{assetsBase}}images/google-home.svg">
                           <div class="property-panelIconTitle">{{"Google_asstnt"| i18nString}}<i class="fa  fa-caret-left leftArrow"></i></div>
                        </span>
                        <span ng-if="prompt.channel!=='default' && prompt.channel==='skype' && prompt.channel!=='wfacebook'" class="Oval-15 no-background" tooltip-placement="right" tooltip="{{channelsConfig.channelsObject[prompt.channel].name}}"><span class="img fa fa-{{prompt.channel}}"  ng-src="{{channelsConfig.channelsObject[prompt.channel].icon}}" aria-hidden="true"></span> </span>
                        <span ng-if="prompt.channel==='wfacebook'" class="Oval-15 no-background" tooltip-placement="right" tooltip="{{prompt.isMention?_constants_.iconsTooltips['Workplace For Groups']:_constants_.iconsTooltips['Workplace For Chat']}}"><img class="img fa fa-{{prompt.channel}}"  ng-src="{{channelsConfig.channelsObject[prompt.channel].icon}}" aria-hidden="true"></span>
                     </span>
                     <span class="msgDecription">{{prompt.type=='uxmap'?'Javascript Message':decodeJS(prompt.text)}}</span>
                     <span class="delete btx-delete-1 fa-trash" ng-class="{'pointer-none': selectedState === 'published'}" ng-click="deleteMessage(prompt,$index)"></span>
                     <span class="edit btx-pencil fa-pencil" ng-click="editResponse($index)"></span>
                  </div>
               </div>             
               <div class="help_hint_data mb-0">
                  <div class="bulb-icon">
                      <i class="btx-bulb"></i>
                  </div>
                  <div class="hint-content">{{"handle_nl"| i18nString}}</div>
              </div>
            </div>
         </div>
         <div class="col-xs-12 form-group radioDiv  pointerEventNone noPadding">
            <div class="col-xs-12 noPadding">
               <label class="required-field">{{"call_handler"| i18nString}}</label>
            </div>
            <div class="grayInfoText col-xs-12 noPadding marginT5 marginBottom10">{{"specify_intent"| i18nString}}</div>
            <div class="col-xs-12  noPadding" ng-class="{'screenFreeze':streamState=='published'}">
               <select ng-model="ivrSettingsSupp.callTerminationHandler" class="" name="callTermination" required="">
                  <option ng-repeat="task in dialogsName" value="{{task.id}}">
                     {{task.name}}
                  </option>
               </select>
               <div error-alert ng-show="(ivrSettSupp.ivrForm.callTermination.$error.required && submitForm)" class="text-danger">{{"provide_call"| i18nString}}</div>
            </div>
         </div>
         <div class="col-xs-12 vxmlIvr-property  orm-group  noPadding pointerEventNone" ng-if="cb.isFrom == 'audiocodes' || cb.isFrom == 'propPanelAudiocodes'" ng-class="{'screenFreeze':streamState=='published'}">
            <div class="col-xs-12 noPadding marginTop10 ">
                <div class="col-xs-6 noPadding">
                    <label>{{'call_control_params'| i18nString}}</label>
                    <div class="grayInfoText noPadding marginT5 ">
                        {{'call_control_desc' | i18nString}}
                    </div>
                </div>
                <div ng-hide="ivrSettingsSupp.properties.length === 0" class="col-xs-6 noPadding">
                    <button type='button' class="btn btn-primary pull-right"  ng-click="addProperty('add')">{{'add_parameter'| i18nString}}</button>
                </div> 
            </div>
            <div class="col-xs-12 bottomBorder darkBottomBorder" ng-show="ivrSettingsSupp.properties.length">
                <div class="col-xs-5 padding15">
                    <div ng-show="!showNameSearch" class="headerTitle"><span class="name">{{'bot_name'| i18nString}}</span><span class="btx-search fa-search" ng-click="activateNameSearch(true)"></span></div>
                    <div ng-show="showNameSearch" class="searchVariable">
                        <input focus-it tabindex="1" type="text" class="form-control " ng-model="ivr.nameSearchQuery" ng-keyup="trackSearch($event)" ng-change="searchRecords('name')" placeholder="{{'search_var_name'| i18nString}}">
                        <span class="btx-close" ng-click="activateNameSearch(false)"></span>
                    </div>
                </div>
                <div class="col-xs-5 padding15">
                    <div ng-show="!showValueSearch" class="headerTitle"><span class="name">{{'value_caps'| i18nString}}</span><span class="btx-search fa-search" ng-click="activateValueSearch(true)"></span></div>
                    <div ng-show="showValueSearch" class="searchVariable">
                        <input focus-it tabindex="1" type="text" class="form-control " ng-model="ivr.nameSearchQuery" ng-keyup="trackSearch($event)"  ng-change="searchRecords('value')" placeholder="{{'search_var_value'| i18nString}}">
                        <span class="btx-close" ng-click="activateValueSearch(false)"></span>
                    </div>
                </div>
            </div>
            <!-- List of VXMLProperties -->
            <div ng-show="tempProperty.length" class="bottomBorder col-xs-12 noPadding editVariables" ng-class="'botVariable' + $index" ng-repeat="variable in tempProperty track by $index">
                <div class="col-xs-12">
                    <div class="col-xs-5 padding15">
                        {{variable.name}}
                    </div>
                    <div class="col-xs-5 padding15">
                        <div class="ellipsis"> {{variable.value}}</div>
                    </div>
                    <div class="col-xs-2  padding15 editVariableIcons">
                        <div class="variableTitle iconsDiv">
                            <span ng-click="editProperty($index, variable)" class="btx-pencil fa-pencil"></span><span class="btx-delete-1 fa-trash" ng-click="deleteProperty($index, variable)"></span><span ng-show="false" class="fa fa-spin fa-refresh"></span>
                        </div>
                    </div>
                </div>
            </div>
            <div ng-show="ivrSettingsSupp.properties.length !== 0 && tempProperty.length === 0">
                <p class="col-xs-12 searchNoVariables">{{'VXML_props'| i18nString}}</p>
            </div>
            <div ng-show="ivrSettingsSupp.properties.length === 0">
                <button type='button' class="btn btn-primary noMargin"  ng-click="addProperty('add')">{{'add_parameter'| i18nString}}</button>
            </div>
        </div>



         <div class="col-xs-12 form-group radioDiv  noPadding pointerEventNone">
            <div class="col-xs-12 noPadding">
               <label class="required-field">{{"timeout_prompt"| i18nString}}</label>
            </div>
            <div class="grayInfoText col-xs-12 noPadding marginT5 marginBottom10">{{"define_prompt"| i18nString}}</div>
            <div class="col-xs-12  noPadding" ng-class="{'screenFreeze':streamState=='published'}">
               <textarea  type="text" class="form-control" name="timeoutPrompts"
                  ng-model="ivrSettingsSupp.timeoutPrompts[0][0].value"
                  auto-grow-textarea
                  maxlength="4000"
                  id="timeoutPrompts" placeholder="Enter plain text prompt" required>
                </textarea>
               <div>
                  <div error-alert ng-show="(ivrSettSupp.ivrForm.timeoutPrompts.$error.required && submitForm)"  class="text-danger">
                     {{"provide_timeout"| i18nString}}
                  </div>
               </div>
            </div>
         </div>
         <div class="col-xs-12 form-group radioDiv  noPadding pointerEventNone">
            <div class="col-xs-12 noPadding radioDiv">
               <label>{{"adv_item"| i18nString}}</label>
            </div>
            <div class="grayInfoText col-xs-12 noPadding marginT5 marginBottom10">{{"def_progress"| i18nString}}</div>
            <div ng-class="{'screenFreeze':streamState=='published'}">
               <toggle-switch ng-model="ivrSettingsSupp.bargein" yes-no="true" class="pull-left toggleNoMargin">
               </toggle-switch>
            </div>
         </div>
         <div class="col-xs-12 form-group  noPadding pointerEventNone">
            <div class="col-xs-12 noPadding">
               <label>{{"timeout"| i18nString}}</label>
            </div>
            <div class="grayInfoText col-xs-12 noPadding marginT5 marginBottom10">{{"wait_time"| i18nString}}</div>
            <div class="col-xs-12  noPadding" ng-class="{'screenFreeze':streamState=='published'}">
               <select ng-model="ivrSettingsSupp.timeout" ng-options="(convertToInt(time/1000) +' '+(convertToInt(time/1000) == 1?'Sec':'Secs')) for time in timeIntervels">
               </select>
            </div>
         </div>
         <div class="col-xs-12 form-group  noPadding pointerEventNone ">
            <div class="col-xs-12 noPadding">
               <label>{{"no_retries"| i18nString}}</label>
            </div>
            <div class="grayInfoText col-xs-12 noPadding marginT5 marginBottom10">{{"max_retries"| i18nString}}</div>
            <div class="col-xs-12  noPadding" ng-class="{'screenFreeze':streamState=='published'}">
               <select ng-model="ivrSettingsSupp.retry_limit" ng-options="convertToInt(entries) for entries in retriesCount">
               </select>
            </div>
         </div>
    </form>
    <div ng-if="isLoading" class="new-app-channel-loading">
      <i class="fa fa-spinner"></i>
      Please Wait...
    </div>

    <bot-modal-slider id="addResponseChannelSupp" ng-if="show.enable">
      <div class="modalSliderContainer width700 welcomeMessageContainer welcomeMessageModal  form-group" ng-if='channel_supp_ivr_cb.isAddResponseEnabled'>
         <bt-welcome-message cb="channel_supp_ivr_cb"></bt-welcome-message>
      </div>
   </bot-modal-slider>

   <bot-modal-slider id="vxmlProp" ng-if="showEnable">
      <div class="modalSliderContainer width700">
          <div class="modalHeader">
              <h4 class="modal-title" id="gridSystemModalLabel">
                   <i  class="btx-carrot-left" ng-click="cancleCreate()"></i>
                       {{'add_call_params'| i18nString}}
              </h4>
          </div>
          <div class="modalBody nodeChannelSlider" perfect-scroll dynamic-height dynaoffset="-115" height-property="height">              
               <div class="kr-sg-input-text mb-15">
                  <div class="label-text">{{'param_name_caps'| i18nString}}</div>
                  <input name="vxmlproperty" ng-model="vxmlproperty.name" type="text" placeholder="{{'place_param'| i18nString}}" class="input-text">                  
               </div>

               <div class="kr-sg-input-text mb-15">
                  <div class="label-text">{{'param_value_caps'| i18nString}}</div>
                  <input type="text" name="variableValue" ng-model="vxmlproperty.value" placeholder="{{'Vprop_value_placehol'| i18nString}}" class="input-text">                  
               </div>

          </div>
          <div class="modalFooter">
              <div class="col-xs-12">
                  <button ng-if='!saveEdit' ng-click="createProperty('new')" ng-disabled="saving" class="btn"> {{(saving)?savingLabel:save}}</button>
                  <button ng-if='saveEdit' ng-click="createProperty('edit')" ng-disabled="saving" class="btn"> {{(saving)?savingLabel:save}}</button>
                  <button ng-click="cancleCreate()" class="btn closeCancel"> {{'cancel'| i18nString}}</button>
              </div>
          </div>
      </div>
  </bot-modal-slider> 

</div>